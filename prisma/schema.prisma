generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Person {
  id               Int          @id @default(autoincrement())
  firstName        String
  lastName         String?
  birth            DateTime?
  death            DateTime?
  imageUrl         String?
  biography        String?
  gender           String?
  isAlive          Boolean?     @default(true)
  originPlace      String?
  spouseId         Int?         @unique
  fatherId         Int?
  motherId         Int?
  CheraFamily      CheraFamily?
  father           Person?      @relation("FatherRelation", fields: [fatherId], references: [id])
  childrenOfFather Person[]     @relation("FatherRelation")
  mother           Person?      @relation("MotherRelation", fields: [motherId], references: [id])
  childrenOfMother Person[]     @relation("MotherRelation")
  spouse           Person?      @relation("SpouseRelation", fields: [spouseId], references: [id])
  spouseOf         Person?      @relation("SpouseRelation")

  User User[]
}

model User {
  id           Int      @id @default(autoincrement())
  username     String   @unique
  password     String
  role         Role     @default(GUEST)
  createdAt    DateTime @default(now())
  rootPersonId Int?
  rootPerson   Person?  @relation(fields: [rootPersonId], references: [id])
}

model CheraFamily {
  id           Int     @id @default(autoincrement())
  name         String  @unique
  description  String?
  familyHeadId Int?    @unique
  familyHead   Person? @relation(fields: [familyHeadId], references: [id])
}

enum Role {
  ADMIN
  GUEST
}
